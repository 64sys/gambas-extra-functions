' Gambas class file

Private stxGDir As New String[] ' Lista de directorios que contienen proyectos Gambas
Private stxProjCurrent As New String[] ' Informacion del proyecto actual

Public Sub btnAddressIP_Click()

  Dim strIP As String

  strIP = GEFSys.AddressIP()
  Message.Info(strIP)

End

Public Sub btnLANIP_Click()

  Dim stxIP As New String[]

  stxIP = GEFSys.LANIP()
  Message.Info(stxIP.Join("\n"))

End

Public Sub ButtonBox1_Click()

  '  Open.Dialog(Dialog.Path)

End

Public Sub Form_Open()

  dioProjects.Value = Application.Path
  LoadProjects(Application.Path)

  hzsProjects.Layout = [1, 3, 1]

End

Private Function LoadProjects(strPath As String) As Integer

  Dim stxProj As New String[]
  Dim strOut As String
  Dim stxOut As New String[]
  Dim int As Integer
  Dim strClss As String
  Dim strMeth As String
  Dim strDesc As String
  Dim strFile As String
  Dim strInit As String
  Dim strEnd As String
  Dim stxDirs As New String[]
  Dim strDir As String
  'Dim stxGDir As New String[]
  Dim stxTmp As String[]

  'strPath = dioProjects.Value
  strOut = "/tmp" &/ "method-map.txt"
  ' Obtencion de la lista de directorios
  stxDirs = GEFUtility.RListDir(strPath)
  ' Filtrado de directorios que sean proyectos Gambas
  For Each strDir In stxDirs
    If GEFUtility.DirGambas(strDir) = True Then
      stxGDir.Add(strDir)
    Endif
  Next

  stxProj = GEFUtility.DokuProj(strPath)

  If stxProj.Count > 0 Then

    For int = 0 To stxProj.Max
      strFile = Split(stxProj[int], "\t")[0]
      strClss = Split(stxProj[int], "\t")[1]
      strMeth = Split(Split(stxProj[int], "\t")[2], "\n")[4]
      strDesc = Split(Split(stxProj[int], "\t")[2], "\n")[7]
      strInit = Split(stxProj[int], "\t")[5]
      strEnd = Split(stxProj[int], "\t")[6]
      stxOut.Add(strFile & "\t" & strInit & ":" & strEnd & "\t" & strClss & "." & strMeth & "\t" & strDesc)
    Next

    File.Save(strOut, stxOut.Join("\n"))
    Wait 0.1
    Desktop.Open(strOut)
  Endif

End

Public Sub ToolButton1_Click()

  LoadProjects(dioProjects.Value)

End

Private Sub LoadTree()

  Dim strDir As String
  Dim strPic As String

  trvProjects.Clear

  For Each strDir In stxGDir
    trvProjects.Add()
  Next

End

Private Sub MakeControls()

End
